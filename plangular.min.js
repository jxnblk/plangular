/*

        PLANGULAR
        A Highly Customizable SoundCloud Player

        http://jxnblk.github.io/Plangular

 */
"use strict";var plangular=angular.module("plangular",[]),clientID="0d33361983f16d2527b01fbf6408b7d7";SC.initialize({client_id:clientID}),plangular.directive("plangular",function(t,a){var r=t[0].createElement("audio"),n={track:!1,playing:!1,paused:!1,tracks:null,i:null,play:function(t,a){null==a&&(t=Array(t),a=0),n.tracks=t,n.track=t[a],n.i=a,n.paused!=n.track&&(r.src=n.track.stream_url+"?client_id="+clientID),r.play(),n.playing=n.track,n.paused=!1},pause:function(){r.pause(),n.playing&&(n.paused=n.playing,n.playing=!1)},playPlaylist:function(t){n.tracks==t.tracks&&n.paused?n.play(n.tracks,n.i):n.play(t.tracks,0)},next:function(t){t?t&&t.tracks==n.tracks&&(n.i+1<n.tracks.length?(n.i++,n.play(t.tracks,n.i)):n.pause()):n.i+1<n.tracks.length?(n.i++,n.play(n.tracks,n.i)):n.pause()},previous:function(t){t.tracks==n.tracks&&n.i>0&&(n.i=n.i-1,n.play(t.tracks,n.i))}};return r.addEventListener("ended",function(){a.$apply(function(){n.tracks.length>0?n.next():n.pause()})},!1),{restrict:"A",scope:{src:"="},link:function(t){SC.get("/resolve.json?url="+t.src,function(a){t.$apply(function(){a.tracks?t.playlist=a:"track"==a.kind?t.track=a:t.data=a})}),t.player=n,t.audio=r,t.currentTime=0,t.duration=0,r.addEventListener("timeupdate",function(){(t.track==n.track||t.playlist&&t.playlist.tracks==n.tracks)&&t.$apply(function(){t.currentTime=(1e3*r.currentTime).toFixed(),t.duration=(1e3*r.duration).toFixed()})},!1),t.seekTo=function(t){var a=t.offsetX/t.target.offsetWidth;r.currentTime=a*r.duration}}}}),plangular.filter("playTime",function(){return function(t){var a=Math.floor(t/36e5),r="0"+Math.floor(t%36e5/6e4),n="0"+Math.floor(t%6e4/1e3);return r=r.substr(r.length-2),n=n.substr(n.length-2),isNaN(n)?"00:00":a?a+":"+r+":"+n:r+":"+n}});
!function(){"use strict";var a=angular.module("plangular",[]);a.directive("plangular",["$http","plangularConfig",function(a,b){var c=b.clientId,d=document.createElement("audio"),e={currentTrack:!1,playing:!1,tracks:[],i:0,playlistIndex:0,data:{},currentTime:0,duration:0,load:function(a,b){this.tracks[b]=a,this.playing||this.i||0!=b||(this.currentTrack=this.tracks[0])},play:function(a,b){this.i=a||0;var e=this.tracks[this.i];if(e.tracks){this.playlistIndex=b||0,this.playing=e.tracks[this.playlistIndex];var f=e.tracks[this.playlistIndex].stream_url+"?client_id="+c}else{this.playing=e;var f=e.stream_url+"?client_id="+c}this.currentTrack=this.playing,f!=d.src&&(d.src=f),d.play()},pause:function(){d.pause(),this.playing=!1},playPause:function(a,b){var c=this.tracks[a];c.tracks&&this.playing!=c.tracks[b]?this.play(a,b):c.tracks||this.playing==c?this.pause():this.play(a)},next:function(){var a=this.tracks[this.i].tracks||null;if(a&&this.playlistIndex<a.length-1)this.playlistIndex++,this.play(this.i,this.playlistIndex);else if(this.i<this.tracks.length-1)if(this.i++,this.tracks[this.i].tracks){var a=this.tracks[this.i].tracks||null;this.playlistIndex=0,this.play(this.i,this.playlistIndex)}else this.play(this.i);else this.i>=this.tracks.length-1&&this.pause()},previous:function(){var a=this.tracks[this.i].tracks||null;a&&this.playlistIndex>0?(this.playlistIndex--,this.play(this.i,this.playlistIndex)):this.i>0&&(this.i--,this.tracks[this.i].tracks?(this.playlistIndex=this.tracks[this.i].tracks.length-1,this.play(this.i,this.playlistIndex)):this.play(this.i))},seek:function(a){if(!d.readyState)return!1;var b=a.offsetX/a.target.offsetWidth;d.currentTime=b*d.duration}};d.addEventListener("timeupdate",function(){e.currentTime=d.currentTime,e.duration=d.duration},!1),d.addEventListener("ended",function(){e.tracks.length>0?e.next():e.pause()},!1);var f=0;return{restrict:"A",scope:!0,link:function(b,g,h){function i(a){for(var c in a)b[c]=a[c]}var j=h.plangular,k={url:j,client_id:c,callback:"JSON_CALLBACK"};b.player=e,b.audio=d,b.currentTime=0,b.duration=0,j&&(b.index=f,f++),j&&(e.data[j]?(b.track=e.data[j],i(b.track)):a.jsonp("//api.soundcloud.com/resolve.json",{params:k}).success(function(a){b.track=a,i(b.track),e.data[j]=a,e.load(a,b.index)})),b.play=function(a){e.play(b.index,a)},b.pause=function(){e.pause()},b.playPause=function(a){e.playPause(b.index,a)},b.next=function(){e.next()},b.previous=function(){e.previous()},d.addEventListener("timeupdate",function(){b.track==e.tracks[e.i]&&b.$apply(function(){b.currentTime=e.currentTime,b.duration=e.duration})},!1),b.seek=function(a){e.tracks[e.i]==b.track&&e.seek(a)}}}}]),a.directive("plangularIcon",function(){var a={play:"M0 0 L32 16 L0 32 z",pause:"M0 0 H12 V32 H0 z M20 0 H32 V32 H20 z",previous:"M0 0 H4 V14 L32 0 V32 L4 18 V32 H0 z",next:"M0 0 L28 14 V0 H32 V32 H28 V18 L0 32 z",close:"M4 8 L8 4 L16 12 L24 4 L28 8 L20 16 L28 24 L24 28 L16 20 L8 28 L4 24 L12 16 z",chevronRight:"M12 1 L26 16 L12 31 L8 27 L18 16 L8 5 z",chevronLeft:"M20 1 L24 5 L14 16 L24 27 L20 31 L6 16 z",heart:"M0 10 C0 6, 3 2, 8 2 C12 2, 15 5, 16 6 C17 5, 20 2, 24 2 C30 2, 32 6, 32 10 C32 18, 18 29, 16 30 C14 29, 0 18, 0 10"};return{restrict:"A",scope:!0,link:function(b,c,d){var e=c[0],f=d.plangularIcon,g=document.createElementNS("http://www.w3.org/2000/svg","path");if(!a[f]){var h="";for(var i in a)h+=i+", ";return console.error("No icon found for "+f+".\n\nIcons available:\n"+h+"\n\nMore icons available from http://jxnblk.github.io/geomicons-open"),!1}e.classList.add("plangular-icon","plangular-icon-"+f),e.setAttribute("viewBox","0 0 32 32"),e.setAttribute("style","max-height:100%"),e.setAttribute("fill","currentColor"),g.setAttribute("d",a[f]),e.appendChild(g)}}}),a.filter("prettyTime",function(){return function(a){var b=Math.floor(a/3600),c="0"+Math.floor(a%3600/60),d="0"+Math.floor(a%60);return c=c.substr(c.length-2),d=d.substr(d.length-2),isNaN(d)?"00:00":b?b+":"+c+":"+d:c+":"+d}}),a.provider("plangularConfig",function(){this.clientId="0d33361983f16d2527b01fbf6408b7d7";var a=this;this.$get=function(){return{clientId:a.clientId}}})}();